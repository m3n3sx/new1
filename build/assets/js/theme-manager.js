class ThemeManager{constructor(){this.currentTheme=this.detectTheme();this.storageKey='las-theme-preference';this.init();}detectTheme(){const stored=localStorage.getItem(this.storageKey);if(stored &&(stored==='dark' || stored==='light')){return stored;}if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){return 'dark';}return 'light';}setTheme(theme){if(theme !=='dark' && theme !=='light'){console.warn('ThemeManager: Invalid theme value. Use "dark" or "light".');return;}this.currentTheme=theme;document.documentElement.setAttribute('data-theme',theme);localStorage.setItem(this.storageKey,theme);this.dispatchThemeChange();this.updateThemeToggles();}toggleTheme(){const newTheme=this.currentTheme==='dark' ? 'light' : 'dark';this.setTheme(newTheme);}getCurrentTheme(){return this.currentTheme;}isDark(){return this.currentTheme==='dark';}isLight(){return this.currentTheme==='light';}init(){this.setTheme(this.currentTheme);if(window.matchMedia){const mediaQuery=window.matchMedia('(prefers-color-scheme: dark)');if(mediaQuery.addEventListener){mediaQuery.addEventListener('change',(e)=>{if(!localStorage.getItem(this.storageKey)){this.setTheme(e.matches ? 'dark' : 'light');}});}else if(mediaQuery.addListener){mediaQuery.addListener((e)=>{if(!localStorage.getItem(this.storageKey)){this.setTheme(e.matches ? 'dark' : 'light');}});}}this.initializeThemeToggles();this.preventFOUC();}dispatchThemeChange(){const event=new CustomEvent('las-theme-change',{detail:{theme: this.currentTheme,isDark: this.isDark(),isLight: this.isLight()}});window.dispatchEvent(event);if(document.dispatchEvent){document.dispatchEvent(event);}}initializeThemeToggles(){const toggleButtons=document.querySelectorAll('[data-las-theme-toggle]');toggleButtons.forEach(button=>{button.addEventListener('click',(e)=>{e.preventDefault();this.toggleTheme();});this.updateThemeToggleButton(button);});}updateThemeToggles(){const toggleButtons=document.querySelectorAll('[data-las-theme-toggle]');toggleButtons.forEach(button=>{this.updateThemeToggleButton(button);});}updateThemeToggleButton(button){const isDark=this.isDark();const lightText=button.getAttribute('data-light-text')|| '☀️ Light';const darkText=button.getAttribute('data-dark-text')|| '🌙 Dark';if(button.textContent !==undefined){button.textContent=isDark ? lightText : darkText;}button.setAttribute('aria-label',`Switch to ${isDark ? 'light' : 'dark'}theme`);button.setAttribute('data-current-theme',this.currentTheme);button.classList.toggle('las-theme-toggle--dark',isDark);button.classList.toggle('las-theme-toggle--light',!isDark);}preventFOUC(){document.documentElement.classList.remove('las-theme-loading');document.documentElement.classList.add('las-theme-loaded');setTimeout(()=>{const settingsWrap=document.querySelector('.las-fresh-settings-wrap');if(settingsWrap){settingsWrap.style.opacity='1';}},100);}onThemeChange(callback){const handler=(event)=>{callback(event.detail);};window.addEventListener('las-theme-change',handler);return()=>{window.removeEventListener('las-theme-change',handler);};}resetTheme(){localStorage.removeItem(this.storageKey);const systemTheme=window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';this.setTheme(systemTheme);}getThemeStats(){return{currentTheme: this.currentTheme,hasStoredPreference: !!localStorage.getItem(this.storageKey),systemPreference: window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light',supportsColorScheme: !!window.matchMedia,toggleButtons: document.querySelectorAll('[data-las-theme-toggle]').length};}}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>{window.lasThemeManager=new ThemeManager();});}else{window.lasThemeManager=new ThemeManager();}if(typeof module !=='undefined' && module.exports){module.exports=ThemeManager;}if(typeof define==='function' && define.amd){define([],function(){return ThemeManager;});}